<html>
    <head>
        <title>RevBayes Manual Pages :: Index Page</title>
        <link rel="stylesheet" type="text/css" href="../lib/help.css"/>     

        <script src="../lib/jquery.js"></script>
        
        <script>
            function navigateHelp(entry) {
                window.open("pages/" + entry + ".html");
            }
        </script>

        <script>
            var showFunctions, showTypes, filter;
            var manualEntries, functionEntries, typeEntries;
            var showMore;
            $(document).ready(function() {
                
                // assign variables
                showFunctions = $("#showFunctions");
                showTypes = $("#showTypes");
                filter = $("#filter");

                manualEntries = $("#manualEntries");
                functionEntries = $("#functionEntries");
                typeEntries = $("#typeEntries");
                
                // hide per default
                manualEntries.find("[id$=less-label]").each(function() {
                    $(this).hide();
                });
                manualEntries.find("[id$=more-content]").each(function() {
                    $(this).hide();
                });

                // configure events
                showFunctions.on('click', function() {
                    functionEntries.slideToggle();
                });

                showTypes.on('click', function() {
                    typeEntries.slideToggle();
                });

                filter.on('input', function() {
                    doFilter(functionEntries, $(this).val());
                    doFilter(typeEntries, $(this).val());
                });

                
            });

            function doFilter(section, filterString) {
                section.children().each(function() {
                    if (filterString.length == 0) {
                        $(this).fadeIn();
                    }
                    else {
                        $(this).hide();
                    }
                });
                if (filterString.length > 0) {
                    section.children("[id^=" + filterString + "]").each(function() {
                        $(this).fadeIn();
                    });
                }
            }

            function showMore(entry) {
                $("#" + entry + "-more-label").toggle();
                $("#" + entry + "-less-label").toggle();

                $("#" + entry + "-more-content").slideDown();
            }

            function showLess(entry) {
                $("#" + entry + "-more-label").toggle();
                $("#" + entry + "-less-label").toggle();
                $("#" + entry + "-more-content").slideUp();
            }

        </script>

    </head>
    <body>
        <div class="filter-bar">
            <div class="filter-controls">
                <label for="showFunctions"> || Show functions</label>
                <input type="checkbox" id="showFunctions" checked="checked" />

                <label for="showTypes"> || Show types</label>
                <input type="checkbox" id="showTypes" checked="checked" />

                <label for="filter"> || Name</label>
                <input type="text" id="filter" placeholder="Filter by name..."/>
            </div>
        </div>
        <br />
        <h1>RevBayes Manual Pages :: Index</h1>

        <div id="manualEntries">
            
            <br/>            
            <div class="section-label"><strong><em>Functions</em></strong></div>            
            <div id="functionEntries"><div id="cBDP">
    <span onClick="navigateHelp('cBDP-function');">
        <a href=""><h2>cBDP - function</h2></a>
    </span> 
    <input type="hidden" id="entry-type" value="function" />
    
    <!--<a href="#entry-file#">View</a>-->
    <div class="indent"><p>
                The constant-rate birth-death process species a prior probability distribution on time trees. The birth (speciation) and death (extinction)
                rates are assumed to be constant over time. Unlike some implementations, cBDP does not constrain the birth rate to be larger than the death
                rate.
            </p></div>    
    <a href="" onClick="showMore('cBDP'); return false;" class="indent more-label" id="cBDP-more-label" >Show more... >></a>
    <a href="" onClick="showLess('cBDP'); return false;" class="indent more-label" id="cBDP-less-label" ><< Show less</a>
    <div class="indent more-content" id="cBDP-more-content"><br />
<h2>Name</h2>
<p class="indent">cBDP</p>
<h2>Description</h2>
<p class="indent"><p class="indent">
                The constant-rate birth-death process species a prior probability distribution on time trees. The birth (speciation) and death (extinction)
                rates are assumed to be constant over time. Unlike some implementations, cBDP does not constrain the birth rate to be larger than the death
                rate.
            </p>
</p>
<h2>Usage</h2>
<p class="indent">
        ConstBDProcess cBDP(
                             RealPos        lambda,
                             RealPos        mu = 0.0,
                             RealPos        origin,
                             Probability    rho = 1.0,
                             String         samplingStrategy="uniform",
                             String         condition="survival",
                             Natural        nTaxa,
                             Vector<String> names,
                             Vector<Clade>  constraints
                           )
        </p>
<h2 >Arguments</h2>
<div class="indent">
<b >lambda</b>
<div class="indent">
Birth (speciation) rate.<br />
<br />
<span class="argument">Argument type: </span>
dynamic<br />
<span class="argument">Value type: </span>
Positive real number<br />
</div>
<br />
<b >mu</b>
<div class="indent">
Death (extinction) rate.<br />
<br />
<span class="argument">Argument type: </span>
dynamic<br />
<span class="argument">Value type: </span>
Positive real number<br />
</div>
<br />
<b >origin</b>
<div class="indent">
The time of the process since the origin, i.e., the length of the stem branch plus the crown age.<br />
<br />
<span class="argument">Argument type: </span>
dynamic<br />
<span class="argument">Value type: </span>
Positive real number<br />
</div>
<br />
<b >rho</b>
<div class="indent">
The taxon sampling probability/fraction.<br />
<br />
<span class="argument">Argument type: </span>
dynamic<br />
<span class="argument">Value type: </span>
Positive real number between 0.0 and 1.0<br />
<span class="argument">Default value</span>
1.0<br />
</div>
<br />
<b >samplingStrategy</b>
<div class="indent">
The sampling strategy used if the taxon sampling is incomplete.<br />
<br />
<span class="argument">Argument type: </span>
fixed<br />
<span class="argument">Value type: </span>
String<br />
<span class="argument">Default value</span>
"uniform"<br />
</div>
<br />
<b >condition</b>
<div class="indent">
Conditioning of the process. For details, see below.<br />
<br />
<span class="argument">Argument type: </span>
fixed<br />
<span class="argument">Value type: </span>
String<br />
<br />
<b >Options</b>
<br />
<div class="indent">
"uniform"<br />
"diversified"<br />
<br />
</div>
<span class="argument">Default value</span>
time<br />
</div>
<br />
<b >nTaxa</b>
<div class="indent">
The number of taxa. This is only needed for simulation/initialization purposes when a tree with exactly n taxa is needed in the model.<br />
<br />
<span class="argument">Argument type: </span>
fixed<br />
<span class="argument">Value type: </span>
Natural number<br />
<br />
<b >Options</b>
<br />
<div class="indent">
"time"<br />
"survival"<br />
"tree"<br />
"nTaxa"<br />
<br />
</div>
</div>
<br />
<b >names</b>
<div class="indent">
The taxon labels that will be applied to the simulated tree.<br />
<br />
<span class="argument">Argument type: </span>
fixed<br />
<span class="argument">Value type: </span>
Vector of strings<br />
</div>
<br />
<b >constraints</b>
<div class="indent">
The topological constraints applied to the tree, i.e., conditioning on the occurence of the split between the clade and the remaining tree.<br />
<br />
<span class="argument">Argument type: </span>
fixed<br />
<span class="argument">Value type: </span>
Vector of clades<br />
<span class="argument">Default value</span>
NULL<br />
</div>
<br />
</div>
<h2>Details</h2>
<p class="indent"><p class="indent">
                The implementation of the constant-rate birth-death process is based on Nee et al. (1994). The unconditioned process results in an improper probability
                distribution, so the process needs to be conditioned on something. Possibilities include to condition the process on the time (duration), on survival
                (non-extinction), on obtaining a tree, or on obtaining the number of observed taxa. The condition of the process is controlled by the 'condition' 
                parameter.
            </p>
<p class="indent">
                The process gives rise to trees with extinct branches, but observed trees typically do not include extinct branches. As implemented here, we
                assume that it is trees without extinct branches, so-called reconstructed trees, that we observe. The probability distribution is modified accordingly.
            </p>
<p class="indent">
                It is commonly the case that the observed tree does not include all tips. The included tips may have been sampled uniformly at random from the available
                complete tree. A particularly common bias is that the investigator has tried to maximize the diversity in the sampled tree, by including tips that are as
                distantly related to each other as possible. This is referred to as diversified sampling. It is critical to model the sampling process
                correctly to obtain accurate estimates of the birth and death rates (Hoehna et al. 2011); particularly the estimate of the death rate is sensitive to
                violations of the sampling assumptions.
            </p>
</p>
<h2>Example</h2>
<p class="indent"><pre >
        trueTree <- readTrees("data/primate.tree")[1]
        
        names <- trueTree.names()
        taxaCount <- names.size()
        
        # Birth-Death process priors
        speciation ~ exponential(0.1)
        extinction ~ exponential(0.1)
        org ~ unif(0.0,50.0)
        
        # moves for the birth-death parameters
        moves[1] <- mScale(speciation, lambda=1, tune=true, weight=2)
        moves[2] <- mScale(extinction, lambda=1, tune=true, weight=2)
        moves[3] <- mSlide(org, delta=1.0, weight=2.0)
       
        # tree from birth-death process
        tau ~ cBDP(origin=org, lambda=speciation, mu=extinction, nTaxa=taxaCount, names=names)
       
        tau.clamp( trueTree )
        
        monitors[1] <- modelmonitor(filename="testBirthDeath.log",printgen=10, separator = "	")
        monitors[2] <- screenmonitor(printgen=1000, separator = "	", speciation)
        
        mymodel <- model(tau)
        
        mymcmc <- mcmc(mymodel, monitors, moves)
        
        mymcmc.burnin(generations=20000,tuningInterval=100)
        mymcmc.run(generations=200000)
        mymcmc.operatorSummary()
        </pre>
</p>
<h2 >Reference</h2>
<p class="indent">
                Nee, S., May, R.M., and Harvey, P.H. 1994. The Reconstructed Evolutionary Process. Philosophical Transactions: Biological Sciences, 344, 305-311
            <br />
http://rstb.royalsocietypublishing.org/content/344/1309/305.short<br />
10.1098/rstb.1994.0068<br />

                Höhna, S., Stadler, T., Ronquist, F, and Britton, T. 2011. Inferring speciation and extinction rates under different species sampling scheme.s Molecular Biology and Evolution, 28, 2577-2589.
            <br />
http://mbe.oxfordjournals.org/content/28/9/2577.short<br />
10.1093/molbev/msr095<br />
</p><br />
<h2>Author</h2>
<p class="indent">Sebastian Hoehna</p>
<br />
<h2 >See also</h2>
<p class="indent"><a href="" onClick="navigateHelp('diversityDependentBirthDeathProcess'); return false;">diversityDependentBirthDeathProcess</a><br />
</p><br />
</div>
</div>

<div id="mcmc">
    <span onClick="navigateHelp('mcmc-function');">
        <a href=""><h2>mcmc - function</h2></a>
    </span> 
    <input type="hidden" id="entry-type" value="function" />
    
    <!--<a href="#entry-file#">View</a>-->
    <div class="indent"><p>
                This function is used to create an MCMC analysis object from a model and associated
                monitors and moves.
            </p></div>    
    <a href="" onClick="showMore('mcmc'); return false;" class="indent more-label" id="mcmc-more-label" >Show more... >></a>
    <a href="" onClick="showLess('mcmc'); return false;" class="indent more-label" id="mcmc-less-label" ><< Show less</a>
    <div class="indent more-content" id="mcmc-more-content"><br />
<h2>Name</h2>
<p class="indent">mcmc</p>
<h2>Description</h2>
<p class="indent"><p class="indent">
                This function is used to create an MCMC analysis object from a model and associated
                monitors and moves.
            </p>
</p>
<h2>Usage</h2>
<p class="indent">
            MCMC mcmc (Model model, Monitor[] monitors, Move[] moves)
        </p>
<h2 >Arguments</h2>
<div class="indent">
<b >model</b>
<div class="indent">

                The model to use in the analysis. The function makes an independent copy of the model
                and stores it internally in the MCMC object.
            <br />
<br />
<span class="argument">Argument type: </span>
fixed<br />
<span class="argument">Value type: </span>
Model<br />
</div>
<br />
<b >monitors</b>
<div class="indent">

                The monitors to use in the analysis. The function makes an independent copy of the monitors
                and stores them internally in the MCMC object.
            <br />
<br />
<span class="argument">Argument type: </span>
fixed<br />
<span class="argument">Value type: </span>
Vector of monitors<br />
</div>
<br />
<b >moves</b>
<div class="indent">

                The moves to use in the analysis. The function makes an independent copy of the moves
                and stores them internally in the MCMC object.
            <br />
<br />
<span class="argument">Argument type: </span>
fixed<br />
<span class="argument">Value type: </span>
Vector of moves<br />
</div>
<br />
</div>
<h2>Details</h2>
<p class="indent"><p class="indent">
                The MCMC analysis object produced by a call to this function keeps copies of the model and the associated moves and monitors.
                The MCMC analysis object is used to run Markov chain Monte Carlo (MCMC) simulation on the model, using the provided moves,
                to obtain a sample of the posterior probability distribution. During the analysis, the monitors are responsible for sampling
                model parameters of interest.
            </p>
</p>
<h2>Example</h2>
<p class="indent"><pre >
            # Create a simple model (unclamped)
            a ~ exponential(1)
            mymodel <- model(a)
            
            # Create a move vector and a monitor vector
            moves[1] <- mScale(a, lambda=1.0, weight=1.0)
            monitors[1] <- modelmonitor("out.txt")
            
            # Create an mcmc object
            mymcmcObject <- mcmc( mymodel, monitors, moves)
            
            # Run a short analysis
            mymcmcObject.run( generations = 100)
        </pre>
</p>
<h2>Author</h2>
<p class="indent">Sebastian Hoehna</p>
<br />
<h2 >See also</h2>
<p class="indent"><a href="" onClick="navigateHelp('MCMC'); return false;">MCMC</a><br />
<a href="" onClick="navigateHelp('model'); return false;">model</a><br />
<a href="" onClick="navigateHelp('Model'); return false;">Model</a><br />
<a href="" onClick="navigateHelp('Move'); return false;">Move</a><br />
</p><br />
</div>
</div>

<div id="powermix">
    <span onClick="navigateHelp('powermix-function');">
        <a href=""><h2>powermix - function</h2></a>
    </span> 
    <input type="hidden" id="entry-type" value="function" />
    
    <!--<a href="#entry-file#">View</a>-->
    <div class="indent"><p>
                This function takes two simplex parameters "a" and "b", and computes a mixture of them by using a simplex parameter "prop"
                with two components as exponents. Each component x[i] in the mixture is computed as:
            </p><p>
                The vector x is then normalized to produce the simplex representing the mixture.
            </p></div>    
    <a href="" onClick="showMore('powermix'); return false;" class="indent more-label" id="powermix-more-label" >Show more... >></a>
    <a href="" onClick="showLess('powermix'); return false;" class="indent more-label" id="powermix-less-label" ><< Show less</a>
    <div class="indent more-content" id="powermix-more-content"><br />
<h2>Name</h2>
<p class="indent">powermix</p>
<h2>Description</h2>
<p class="indent"><p class="indent">
                This function takes two simplex parameters "a" and "b", and computes a mixture of them by using a simplex parameter "prop"
                with two components as exponents. Each component x[i] in the mixture is computed as:
            </p>
<p class="indent">
                The vector x is then normalized to produce the simplex representing the mixture.
            </p>
</p>
<h2>Usage</h2>
<p class="indent">
        Simplex powermix( Simplex a, Simplex b, Simplex prop )
        </p>
<h2 >Arguments</h2>
<div class="indent">
<b >a</b>
<div class="indent">
First simplex of the mixture.<br />
<br />
<span class="argument">Argument type: </span>
dynamic<br />
<span class="argument">Value type: </span>
Simplex<br />
</div>
<br />
<b >b</b>
<div class="indent">
Second simplex of the mixture. It needs to have the same dimension as the first simplex.<br />
<br />
<span class="argument">Argument type: </span>
dynamic<br />
<span class="argument">Value type: </span>
Simplex<br />
</div>
<br />
<b >prop</b>
<div class="indent">
The two exponents (summing to 1) used in computing the elements of the mixture.<br />
<br />
<span class="argument">Argument type: </span>
dynamic<br />
<span class="argument">Value type: </span>
Simplex<br />
</div>
<br />
</div>
<h2>Details</h2>
<p class="indent"><p class="indent">
                This function is useful in computing a mixture of two simplex parameters. The prop parameter determines how much each
                input simplex affects the mixture. When prop = [0.5,0.5], the return value is a mixture where each input simplex has
                the same influence. As the prop parameter approaches one of the two extremes, the corresponding simplex influences the
                mixture to a larger extent. When prop = [1.0,0.0], the mixture is identical to the first input simplex, and when prop = [0.0,1.0],
                the mixture is identical to the second input simplex.
            </p>
</p>
<h2>Example</h2>
<p class="indent"><pre >
        a <- simplex(1,1,1)
        b <- simplex(1,2,3)
        
        # Equal mixture of the two components
        powermix(a,b,simplex(1,1))

        # Make first component more influential in mixture
        powermix(a,b,simplex(10,1))
        
        # Make second component more influential in mixture
        powermix(a,b,simplex(1,10))
        
        # Make mixture dependent only on the first component
        powermix(a,b,simplex(1,0))
        </pre>
</p>
<h2>Author</h2>
<p class="indent">Fredrik Ronquist</p>
<br />
</div>
</div>

</div>
            
            <br/>
            <br/>
            <div class="section-label"><strong><em>Types</em></strong></div>            
            <div id="typeEntries"><div id="MCMC">
    <span onClick="navigateHelp('MCMC-type');">
        <a href=""><h2>MCMC - type</h2></a>
    </span> 
    <input type="hidden" id="entry-type" value="type" />
    
    <!--<a href="#entry-file#">View</a>-->
    <div class="indent"><p>
                The MCMC analysis object keeps a model and the associated moves and monitors.
                The object is used to run Markov chain Monte Carlo (MCMC) simulation on
                the model, using the provided moves, to obtain a sample of the posterior probability
                distribution. During the analysis, the monitors are responsible for sampling model parameters of interest.
            </p></div>    
    <a href="" onClick="showMore('MCMC'); return false;" class="indent more-label" id="MCMC-more-label" >Show more... >></a>
    <a href="" onClick="showLess('MCMC'); return false;" class="indent more-label" id="MCMC-less-label" ><< Show less</a>
    <div class="indent more-content" id="MCMC-more-content"><br />
<h2>Name</h2>
<p class="indent">MCMC</p>
<h2>Description</h2>
<p class="indent"><p class="indent">
                The MCMC analysis object keeps a model and the associated moves and monitors.
                The object is used to run Markov chain Monte Carlo (MCMC) simulation on
                the model, using the provided moves, to obtain a sample of the posterior probability
                distribution. During the analysis, the monitors are responsible for sampling model parameters of interest.
            </p>
</p>
<h2 >Member methods</h2>
<div class="indent">
<b >MCMC</b>
<div class="indent">
 Create an MCMC analysis object (constructor).<br />
<br />
<span class="argument">Usage: </span>

                MCMC MCMC (Model model, Monitor[] monitors, Move[] moves)
            <br />
<span class="argument">Method type :</span>

                mutable
            <br />
<span class="argument">Return value: </span>
An MCMC object<br />
</div>
<br />
<b >run</b>
<div class="indent">
 Run an MCMC analysis.<br />
<br />
<span class="argument">Usage: </span>

                void run (Natural generations)
            <br />
<span class="argument">Method type :</span>

                mutable
            <br />
<span class="argument">Return value: </span>
void<br />
</div>
<br />
<b >burnin</b>
<div class="indent">

                Run a burnin simulation to let the MCMC procedure find the target distribution and to autotune move tuning parameters.
                No parameter values are sampled.
            <br />
<br />
<span class="argument">Usage: </span>

            void burnin (Natural generations, Natural tuningInterval)
            <br />
<span class="argument">Method type :</span>

                mutable
            <br />
<span class="argument">Return value: </span>
void<br />
</div>
<br />
</div>
<h2>Details</h2>
<p class="indent"><p class="indent">
                Markov chain Monte Carlo (MCMC) simulation is a numerical method that, in this program, is used
                to approximate the posterior probability distribution of the parameters of a model. The basic
                sampling mechanism we use is the Metropolis-Hastings algorithm (Metropolis et al. 1953; Hastings 1970).
            </p>
<p class="indent">
                An MCMC simulation is known to converge to the posterior probability distribution, such that the frequency with
                which a particular parameter value is sampled is a valid approximation of its posterior probability. However,
                convergence to the target distribution may be slow, so it is important to assess convergence to ensure that you
                are likely to have a reasonable sample from the posterior.
            </p>
</p>
<h2>Author</h2>
<p class="indent">Sebastian Hoehna</p>
</div>
</div>

</div>
        </div>

        <br />
        <br />
        <br />
        <hr />        
        <p class="footer">
            <b>RevBayes</b>
            <br />
            <i>
                An R-like environment for phylogenetic analysis using Bayesian inference. <br />
                Released under the GPL license, version 3. <br />
            </i>
            Learn more on the <a href="http://sourceforge.net/apps/mediawiki/revbayes/index.php?title=RevBayes_MediaWiki" >RevBayes Wiki</a> 
            <br />
        </p>
    </body>
</html>
